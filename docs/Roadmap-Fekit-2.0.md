# Roadmap: Fekit 2.0 - 赋能前端，极致体验

**所有者**: CTO Office  
**状态**: 规划中  
**版本**: v2.0  
**目标周期**: Q4 2024 - Q1 2025

---

## 1. 愿景与目标

`fekit` v1.0 成功地扮演了 `agentkit` 与 `CopilotKit` 之间的“适配器”角色。在 v2.0 中，我们的愿景是让 `fekit` 进化为一个功能完备、高度可定制的 **AI 前端开发工具包 (SDK)**。

我们的核心目标是：**赋予前端开发者构建任何他们能想象到的 AI 交互界面的能力，同时提供极致流畅、媲美原生应用的交互体验**。

为此，我们将围绕三大核心方向进行深度开发：
- **“无头”组件与 Hooks (Headless Components & Hooks)**
- **丰富的 UI 组件库 (Rich UI Component Library)**
- **前端状态管理优化 (State Management Enhancement)**

---

## 2. 核心方向详述

### 2.1 “无头”组件与 Hooks

> **要解决的问题**: 开发者被 `CopilotKit` 固定的 UI 风格所限制，无法实现高度定制化的界面。
> **目标**: 提供一套不含任何 UI、只包含核心逻辑的 React Hooks，将逻辑与视图彻底分离。

#### 2.1.1 核心 Hooks

- **`useChat()`**: 这是所有聊天交互的核心。它将返回：
    - `messages`: 当前对话的消息列表。
    - `input`: 用户输入框的当前值。
    - `handleInputChange`: 用于更新 `input` 的回调函数。
    - `handleSubmit`: 用于发送消息的回调函数。
    - `isLoading`: 一个布尔值，指示 AI 是否正在生成响应。
    - `error`: 当前发生的错误。
- **`useAgentState()`**: 用于获取和展示 Agent 的内部状态或思考过程。
- **`useTools()`**: 返回当前 Agent 调用的工具列表及其状态（执行中、成功、失败）。

#### 2.1.2 技术实现

- 基于 React Query 或 SWR 进行状态管理，以获得缓存、自动重新获取等高级功能。
- 所有 Hooks 都将从 `CopilotKit` Provider 的 Context 中获取数据。

#### 2.1.3 用户价值

- **极致的灵活性**: 开发者可以利用这些 Hooks 构建任何他们想要的聊天界面，从一个简单的输入框到一个复杂的、类似 IDE 的界面。
- **逻辑复用**: 所有与后端通信、消息管理、状态同步的复杂逻辑都被封装在 Hooks 中，开发者无需关心。

### 2.2 丰富的 UI 组件库

> **要解决的问题**: “无头”组件虽然灵活，但对于想快速上手的开发者来说，从零构建 UI 仍有工作量。
> **目标**: 在“无头”Hooks 的基础上，提供一套官方的、设计精美、可定制的基础 UI 组件库。

#### 2.2.1 核心组件

- **`<Chat />`**: 一个功能完备的聊天组件，它内部使用了 `useChat` hook，并提供了消息展示、输入框、发送按钮等。
- **`<Message />`**: 用于渲染单条消息的组件，能自动处理不同角色（用户、AI、系统）和内容类型（文本、代码块、工具调用）。
- **`<ToolCallVisualizer />`**: 一个专门用于可视化 Agent 工具调用过程的组件，清晰地展示工具名称、参数和返回结果。

#### 2.2.2 技术实现

- 所有 UI 组件都将作为“无头”Hooks 的默认实现。
- 使用 Radix UI 或类似的基础组件库来构建，以确保可访问性（Accessibility）。
- 使用 CSS 变量和 Tailwind CSS 提供强大的主题定制能力。

#### 2.1.3 用户价值

- **快速启动**: 开发者可以像搭积木一样，通过组合这些预置组件快速搭建起一个功能完善的 AI 应用。
- **渐进式定制**: 可以先使用官方 UI 组件，当有更深度的定制需求时，再转向使用底层的“无头”Hooks，学习曲线平滑。

### 2.3 前端状态管理优化

> **要解决的问题**: 等待 AI 响应时的网络延迟会造成界面卡顿，影响用户体验。
> **目标**: 引入先进的状态管理模式，实现极致流畅的交互。

#### 2.3.1 乐观更新 (Optimistic Updates)

- **功能**: 当用户发送一条消息时，不等后端确认，立即将该消息展示在 UI 上，并标记为“发送中”。这会给用户一种“即时响应”的感觉。
- **技术实现**: 在 `useChat` hook 的 `handleSubmit` 方法中实现。当调用成功后，更新消息状态；如果调用失败，则将消息标记为“发送失败”，并提供重试选项。

#### 2.3.2 流式渲染增强

- **功能**: 对 Agent 返回的 SSE 事件流进行更精细化的处理，例如，当 Agent 开始调用工具时，能立刻在 UI 上渲染一个“正在使用工具...”的占位符，而不是等工具执行完毕。
- **技术实现**: 在 `useTools` hook 中增加对“工具调用中”状态的解析和暴露。

#### 2.1.3 用户价值

- **极致的性能感知**: 即使用户的网络环境较差或 AI 响应较慢，前端界面依然能保持高度的流畅和响应性，显著提升用户满意度。

---

## 3. 里程碑与交付计划

- **Milestone 1 (Q4 2024)**:
    - [ ] 完成核心的“无头”Hooks (`useChat`, `useTools`)。
    - [ ] 发布第一个基础 UI 组件 `<Chat />`。
    - [ ] 实现乐观更新。
- **Milestone 2 (Q1 2025)**:
    - [ ] 丰富 UI 组件库，发布 `<ToolCallVisualizer />` 等组件。
    - [ ] 完善文档和示例，提供详细的定制化教程。
    - [ ] 发布 `fekit` v2.0.0-beta 版本。
